<script>
  const shortenBtn = document.getElementById('shorten-btn');
  const resultBox = document.getElementById('result-box');
  const shortUrl = document.getElementById('short-url');
  const copyBtn = document.getElementById('copy-btn');
  const copyStatus = document.getElementById('copy-status');

  // Shorten URL function
  shortenBtn.addEventListener('click', async () => {
    const longUrl = document.getElementById('long-url').value.trim();
    if (!longUrl) {
      alert('Please enter a valid URL.');
      return;
    }

    try {
      shortenBtn.disabled = true;
      shortenBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Shortening...';

      const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`);
      const shortLink = await response.text();

      shortUrl.href = shortLink;
      shortUrl.textContent = shortLink;
      resultBox.style.display = 'block';
    } catch (err) {
      alert('Error shortening URL. Please try again.');
    } finally {
      shortenBtn.disabled = false;
      shortenBtn.innerHTML = '<i class="fas fa-scissors"></i> Shorten URL';
    }
  });

  // ðŸ“‹ Copy to Clipboard with animation
  copyBtn.addEventListener('click', async () => {
    const textToCopy = shortUrl.textContent.trim();
    if (!textToCopy) return;

    try {
      // Try modern clipboard API first
      if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(textToCopy);
      } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = textToCopy;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
      }

      copyStatus.textContent = 'Copied!';
      copyStatus.style.color = 'limegreen';
      copyStatus.classList.add('show');
      setTimeout(() => copyStatus.classList.remove('show'), 1500);
    } catch (err) {
      copyStatus.textContent = 'Failed to copy';
      copyStatus.style.color = 'red';
      copyStatus.classList.add('show');
      setTimeout(() => copyStatus.classList.remove('show'), 1500);
    }
  });
</script>
